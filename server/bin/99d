#!/usr/bin/env python3
import gevent
import nn.funnel as funnel
from nn.handler import load_handler
import sys

if __name__ == '__main__':
    handlers = [load_handler(file) for file in sys.argv[1:]]
    def dispatch(event):
        for handler in handlers:
            gevent.spawn(handler, event)
    funnel.listen(('localhost', 1337), dispatch)
